# Queries

Rail Django automatically generates queries for fetching lists and single items based on your models.

## Standard Queries

For a model named `Product`, the following queries are generated by default:

*   `products`: Fetch a list of products (pluralized name).
*   `product`: Fetch a single product by ID (singular name).

## Filtering

Rail Django uses a structured `where` argument for powerful, nested filtering.

See the dedicated **[Filtering Guide](filtering.md)** for deep details on operators and relations.

```graphql
query {
  # Find products in a specific category with low stock
  products(where: {
    category: { slug: { exact: "electronics" } },
    inventoryCount: { lt: 10 }
  }) {
    name
    sku
    inventoryCount
  }
}
```

## Pagination

Pagination is enabled by default to ensure API performance.

### Offset Pagination (Default)

```graphql
query {
  orders(limit: 10, offset: 0) {
    orderNumber
    totalAmount
  }
}
```

### Relay Connection

If `use_relay` is enabled in settings, standard Relay connections (Edges/Nodes/Cursors) are used.

```graphql
query {
  orders(first: 5) {
    edges {
      node { orderNumber }
      cursor
    }
    pageInfo {
      hasNextPage
    }
  }
}
```

## Sorting

Use the `order_by` argument. You can sort by multiple fields and traverse relationships.

```graphql
query {
  # Sort by customer's last name, then by order date descending
  orders(order_by: ["customer__lastName", "-placedAt"]) {
    orderNumber
    customer {
      lastName
    }
    placedAt
  }
}
```

## Advanced

### Custom Resolvers

You can override the default list or get resolvers in `GraphQLMeta` for complex logic.

```python
class Order(models.Model):
    # ...
    class GraphQLMeta:
        resolvers = GraphQLMeta.Resolvers(
            queries={
                "priority_queue": "resolve_priority_queue",
            }
        )

    @staticmethod
    def resolve_priority_queue(queryset, info, **kwargs):
        # Only return priority orders that haven't been fulfilled
        return queryset.filter(is_priority=True, fulfilled_at__isnull=True)
```

Usage in GraphQL:
```graphql
query {
  orderPriorityQueue {
    orderNumber
    isPriority
  }
}
```
